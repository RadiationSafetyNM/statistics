---
title: "핵의학통계"
description: "개발 중"
author: "BenKorea"
date: "2025-05-29"
date-modified: last-modified
categories: [요양기관 개설현황]
---

핵의학 진료과목을 가진 요양기관을 조사하가 위해
공공데이터포털에서 요양기관개설현황을 raw_data 폴더에 다운로드 하였다.
파일이름을 `요양기관_개설현황_yyyy.csv`로 수정하여 data 폴더에 저장하였다.

```{r}
library(readr)
#| label: fread-list
#| echo: false

library(data.table)

# 1) 대상 CSV 파일 목록
files <- list.files(
  path       = "data",
  pattern    = "^요양기관_개설현황_\\d{4}.*\\.csv$",
  full.names = TRUE
)

# 2) readLines → iconv → fread(text=…) → year 컬럼 추가
hospital_list <- rbindlist(
  lapply(files, function(f) {
    # (1) CP949 인코딩으로 라인 읽기
    raw_lines <- readLines(f, encoding = "CP949")
    # (2) UTF-8로 변환
    utf8_lines <- iconv(raw_lines, from = "CP949", to = "UTF-8")
    # (3) 하나의 문자열로 합쳐 fread에 전달
    dt <- fread(text = paste(utf8_lines, collapse = "\n"))
    # (4) 파일명에서 연도 추출해 추가
    yr <- as.integer(sub(
      ".*요양기관_개설현황_(\\d{4}).*\\.csv$", "\\1",
      basename(f)
    ))
    dt[, year := yr]
    dt
  }),
  use.names = TRUE,
  fill      = TRUE
)

# 3) 결과 확인
head(hospital_list)



```

